## HTTP/HTTPS

#### TCP连接流程
> SYN:同步信号,FIN:断开信号;ACK:1表示应答有效,0无效;SEQ:序列号.
* 三次握手
	1. c->s: SYN, seq=x(改数据包可用作SYN攻击:伪造ip发送该包,服务端回复并等待(半连接态))
	2. s->c: SYN,ACK, seq=y, ackNum=x+1
	3. c->s: ACK, ackNum=y+1
* 传输过程
	1. c->s: ACK,seq=x ackNum=y+1
	2. s->c: ACK,ack=x+1
* 四次挥手
	1. c->s: FIN, seq=x
	2. s->c: ACK,ackNum=x+1
	3. s->c: FIN seq=y
	4. c->s: ACK,ackNum=y+1

#### tcp keepalive
> 通过心跳包保活;连接存活并不保证服务可用

### HTTPS

#### TLS(早期版本为SSL)过程
1. c->s: tls版本,支持的加密,压缩算法
2. s->c: tls版本,数字证书(包含公钥)
3. c->s: CA列表验证证书, 成一串伪随机数并通过公钥加密
4. s->c: 解密随机数,生成对称秘钥
5. c->s:  发送Finished, 使用对称加密这次通讯的散列值
6. s->c: 生成Hash,解密客户端发送来的信息，检查这两个值是否对应。如果对应，就向客户端发送一个 Finished 消息，也使用协商好的对称密钥加密

1,2协商协议版本,加密方式;3,4生成对称秘钥(安全保障,公钥加密的数据,只能私钥解密);
5,6 验证对称秘钥可用.

##### 用到的加密
1. 对称加密DES、AES-GCM、ChaCha20-Poly1305等
2. 非对称加密:RSA、DSA、ECDSA、 DH、ECDHE
3. 哈希算法:MD5、SHA-1、SHA-2、SHA-256
4. 数字签名: 即 哈希后增加(信息hash后的值),防止哈哈被篡改.

##### HTTP风险
1. 窃听风险：黑客可以获知通信内容。
2. 篡改风险：黑客可以修改通信内容。
3. 冒充风险：黑客可以冒充他人身份参与通信。

##### HTTPS
1. 证书的购买和维护成本
2. 加密使用的解析,多次握手带来的性能损失
3. 依旧存在漏洞
	1. SSL剥离,强制使用http访问,可通过`HSTS`技术只允许https访问
	2. 中间人攻击,指攻击者与通讯的两端分别建立独立的联系，并交换其所收到的数据.
	3. 伪造证书攻击.伪造证书进行中间人攻击
		1. 需要攻击服务器,改变dns只想地址
		2. 需要伪造被用户信任的证书.
		3. `HPKP` 通过在头信息存储公钥指纹.发现伪造证书攻击.


	
	
	